<!-- This style is injected ONLY on Read the Docs and it's missing. -->
<style>
 .rtd-current-item {
   font-weight: bold;
 }
</style>
 <script type="text/javascript">
 document.addEventListener("readthedocs-addons-data-ready", function(event) {
     const config = event.detail.data();

     const downloadsNameDisplay = {
      pdf: "PDF",
      epub: "EPUB",
      htmlzip: "HTML",
    };

     // TODO: remove section if there is no content.
     const flyout = `
  <div class="rst-versions" data-toggle="rst-versions" role="note">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: ${ config.versions.current.slug }
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <div class="injected">
        <dl>
          <dt>{{ _('Languages') }}</dt>
          ${ config.projects.translations.map(
            (translation) => `
            <dd ${ translation.slug == config.projects.current.slug ? 'class="rtd-current-item"' : '' }><a href="${ translation.urls.documentation }">${ translation.language.code }</a></dd>
          `).join("\n")}
        </dl>
        <dl>
          <dt>{{ _('Versions') }}</dt>
          ${ config.versions.active.map(
            (version) => `
            <dd ${ version.slug === config.versions.current.slug ? 'class="rtd-current-item"' : '' }><a href="${ version.urls.documentation }">${ version.slug }</a></dd>
          `).join("\n")}
        </dl>
        <dl>
          <dt>{{ _('Downloads') }}</dt>
          ${ Object.entries(config.versions.current.downloads).map(
            ([name, url]) => `
            <dd><a href="${ url }">${ downloadsNameDisplay[name] }</a></dd>
          `).join("\n")}
        </dl>
        <dl>
          <dt>{{ _('On Read the Docs') }}</dt>
            <dd>
              <a href="${ config.projects.current.urls.home }">{{ _('Project Home') }}</a>
            </dd>
            <dd>
              <a href="${ config.projects.current.urls.builds }">{{ _('Builds') }}</a>
            </dd>
            <dd>
              <a href="${ config.projects.current.urls.downloads }">{{ _('Downloads') }}</a>
            </dd>
        </dl>
        <dl>
          <dt>{{ _('Search') }}</dt>
          <dd>
            <div style="padding: 6px;">
              <form id="flyout-search-form">
                <input
                  class="wy-form"
                  type="text"
                  name="q"
                  aria-label="{{ _('Search docs') }}"
                  placeholder="{{ _('Search docs') }}"
                />
              </form>
            </div>
          </dd>
        </dl>
        <hr />
        <small>
          <span>Hosted by <a href="https://readthedocs.org">Read the Docs</a></span>
          <span> &middot; </span>
          <a href="https://docs.readthedocs.io/page/privacy-policy.html">{{ _('Privacy Policy') }}</a>
        </small>
      </div>
    </div>
          `;

     document.body.insertAdjacentHTML("beforeend", flyout);
     document.querySelector("#flyout-search-form").addEventListener("focusin", () => {
         const event = new CustomEvent("readthedocs-search-show");
         document.dispatchEvent(event);
     });
 });
</script>
